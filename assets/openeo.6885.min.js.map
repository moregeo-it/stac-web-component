{"version":3,"file":"openeo.6885.min.js","mappings":"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","sources":["webpack://vue-lib-openeo/./components/internal/StacLinksMixin.js","webpack://vue-lib-openeo/./components/internal/MapMixin.js"],"sourcesContent":["const STAC_MEDIA_TYPES = ['application/geo+json', 'application/json']\n\nexport default {\n\tmethods: {\n\t\tisStacLinkType(link, strict = false) {\n\t\t\tif (typeof link.type === 'undefined') {\n\t\t\t\treturn !strict;\n\t\t\t}\n\t\t\treturn typeof link.type === 'string' && STAC_MEDIA_TYPES.includes(link.type.toLowerCase());\n\t\t},\n\t\tgetStacLinkByRel(links, rel, strict = false) {\n\t\t\tif (!Array.isArray(links)) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\treturn links.find(link => (this.isStacLinkType(link, strict) && typeof link.rel === 'string' && link.rel.toLowerCase() === rel.toLowerCase()));\n\t\t},\n\t\tgetStacLinksByRels(links, rels, strict = false) {\n\t\t\tif (!Array.isArray(links)) {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t\treturn links.filter(link => (this.isStacLinkType(link, strict) && typeof link.rel === 'string' && rels.includes(link.rel.toLowerCase())));\n\t\t}\n  }\n};","import Utils from '../../utils';\nimport { Versions } from '@openeo/js-commons';\n\nexport default {\n\tprops: {\n\t\tmapOptions: {\n\t\t\t// It's not possible to specify defaults for the individual properties, therefore this prop is only accessed through a computed property which adds them in.\n\t\t\ttype: Object,\n\t\t\t// Default values will be set in computed.leafletOptions\n\t\t\tdefault: () => ({}),\n\t\t\tvalidator: function(value) {\n\t\t\t\tconst allowedTypes = {  // keep in sync with Readme\n\t\t\t\t\theight: \"string\",\n\t\t\t\t\twidth: \"string\",\n\t\t\t\t\tbasemap: \"string\",\n\t\t\t\t\tattribution: \"string\",\n\t\t\t\t\twrapAroundAntimeridian: \"boolean\",\n\t\t\t\t\tscrollWheelZoom: \"boolean\"\n\t\t\t\t};\n\t\t\t\tconst allowedKeys = Object.keys(allowedTypes);\n\t\t\t\treturn typeof value == 'object' && Object.keys(value).every(key =>\n\t\t\t\t\tallowedKeys.indexOf(key) != -1 && typeof value[key] == allowedTypes[key]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tmap: null\n\t\t};\n\t},\n\tcomputed: {\n\t\tleafletOptions() {\n\t\t\treturn {  // keep in sync with Readme\n\t\t\t\theight: this.mapOptions.height || '250px',\n\t\t\t\twidth: this.mapOptions.width || 'auto',\n\t\t\t\tbasemap: this.mapOptions.basemap || 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n\t\t\t\tattribution: this.mapOptions.attribution || 'Map data &copy; <a href=\"http://www.osm.org\">OpenStreetMap</a>',\n\t\t\t\tnoWrap: this.mapOptions.wrapAroundAntimeridian === undefined ? true : !this.mapOptions.wrapAroundAntimeridian,  // negate!\n\t\t\t\tscrollWheelZoom: this.mapOptions.scrollWheelZoom === undefined ? false : this.mapOptions.scrollWheelZoom\n\t\t\t}\n\t\t}\n\t},\n\twatch: {\n\t\tshowMap(val) {\n\t\t\tif (val) {\n\t\t\t\tthis.initMap();\n\t\t\t}\n\t\t}\n\t},\n\tbeforeCreate() {\n\t\tUtils.enableHtmlProps(this);\n\t},\n\tmounted() {\n\t\tthis.initMap();\n\t},\n\tmethods: {\n\t\tinitLeafletPlugins() {\n\t\t\t// To be implemented in Collection/Item, if required.\n\t\t},\n\t\tasync initMap() {\n\t\t\tif (!this.$refs.mapContainer) {\n\t\t\t\tawait this.$nextTick();\n\t\t\t}\n\t\t\tif (!this.$refs.mapContainer || this.map !== null || !this.showMap) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t// Only use the L for leaflet temporarily and release it later again\n\t\t\tlet oldL = window.L;\n\t\t\ttry {\n\t\t\t\tthis.map = {\n\t\t\t\t\tleaflet: null,\n\t\t\t\t\tinstance: null,\n\t\t\t\t\tgeometries: null\n\t\t\t\t};\n\t\t\t\t// Leaflet no conflict fix: Try to re-use an already available instance of Leaflet to avoid\n\t\t\t\t// conflicts with other libraries such as ipyleaflet. Also, use L variable as long as initMap\n\t\t\t\t// is running. For all other cases store Leaflet in this.map.leaflet, which can be used in other places.\n\t\t\t\tlet hasLeaflet = () => Utils.isObject(window.L) && Versions.validate(window.L.version) && Versions.compare(window.L.version, \"1.x.x\", \"=\");\n\t\t\t\tif (!hasLeaflet()) {\n\t\t\t\t\twindow.L = await import('leaflet');\n\t\t\t\t}\n\t\t\t\tif (!hasLeaflet()) {\n\t\t\t\t\tconsole.warn(\"Leaflet is not available\");\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tthis.map.leaflet = window.L;\n\n\t\t\t\tlet css = await import('leaflet/dist/leaflet.css');\n\t\t\t\t// In Web Component mode inject the CSS into the shadowroot\n\t\t\t\tif (this.$root && this.$root.$options.shadowRoot && css.__inject__) {\n\t\t\t\t\tcss.__inject__(this.$root.$options.shadowRoot);\n\t\t\t\t}\n\n\t\t\t\tvar map = this.map.leaflet.map(this.$refs.mapContainer, {scrollWheelZoom: this.leafletOptions.scrollWheelZoom});\n\t\t\t\tthis.map.instance = map;\n\t\t\t\tvar osm = this.map.leaflet.tileLayer(this.leafletOptions.basemap, {\n\t\t\t\t\tname: 'Basemap',\n\t\t\t\t\tattribution: this.leafletOptions.attribution,\n\t\t\t\t\tnoWrap: this.leafletOptions.noWrap\n\t\t\t\t});\n\t\t\t\tosm.addTo(map);\n\n\t\t\t\tif (typeof this.addFeatures === 'function') {\n\t\t\t\t\tthis.map.geometries = this.addFeatures();\n\t\t\t\t\tif (this.map.geometries) {\n\t\t\t\t\t\tthis.map.geometries.addTo(map);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Update map container in DOM\n\t\t\t\tthis.$refs.mapContainer.style.width = this.leafletOptions.width;\n\t\t\t\tthis.$refs.mapContainer.style.height = this.leafletOptions.height;\n\t\t\t\tmap.invalidateSize(false);\n\t\t\t\tthis.updateMapView();\n\n\t\t\t\tif (typeof this.mapOptions.onAfterMapInit === 'function') {\n\t\t\t\t\ttypeof this.mapOptions.onAfterMapInit(map, this.map.geometries);\n\t\t\t\t}\n\t\t\t\t// Leaflet no conflict fix: Release L global variable again\n\t\t\t\twindow.L = oldL;\n\t\t\t\treturn true;\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(e);\n\t\t\t\t// Leaflet no conflict fix: Release L global variable again\n\t\t\t\twindow.L = oldL;\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tupdateMapView() {\n\t\t\tif (!this.map || !this.map.geometries) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Compute somewhat smart map extent and zoom level around bbox\n\t\t\tvar bounds = this.map.geometries.getBounds();\n\t\t\tvar zoom = this.map.instance.getBoundsZoom(bounds);\n\t\t\tvar newZoom = Math.min(zoom, 11); // Never zoom closer than 8\n\t\t\tif (zoom > 8) {\n\t\t\t\tnewZoom = newZoom - 3; // Zoom out three levels\n\t\t\t}\n\t\t\telse if (zoom > 5) {\n\t\t\t\tnewZoom = newZoom - 2; // Zoom out two levels\n\t\t\t}\n\t\t\telse if (zoom > 2) {\n\t\t\t\tnewZoom--; // Zoom out one level\n\t\t\t}\n\t\t\tthis.map.instance.fitBounds(bounds);\n\t\t\tthis.map.instance.setZoom(newZoom);\n\n\t\t\tthis.map.instance.once('moveend zoomend', () => this.map.instance.invalidateSize(false));\n\t\t}\n\t}\n};"],"names":["STAC_MEDIA_TYPES","methods","isStacLinkType","link","strict","type","includes","toLowerCase","getStacLinkByRel","links","rel","Array","isArray","find","this","getStacLinksByRels","rels","filter","props","mapOptions","Object","default","validator","value","allowedTypes","height","width","basemap","attribution","wrapAroundAntimeridian","scrollWheelZoom","allowedKeys","keys","every","key","indexOf","data","map","computed","leafletOptions","noWrap","undefined","watch","showMap","val","initMap","beforeCreate","Utils","enableHtmlProps","mounted","initLeafletPlugins","$refs","mapContainer","$nextTick","oldL","window","L","leaflet","instance","geometries","hasLeaflet","isObject","Versions","validate","version","compare","console","warn","css","$root","$options","shadowRoot","__inject__","osm","tileLayer","name","addTo","addFeatures","style","invalidateSize","updateMapView","onAfterMapInit","e","error","bounds","getBounds","zoom","getBoundsZoom","newZoom","Math","min","fitBounds","setZoom","once"],"sourceRoot":""}